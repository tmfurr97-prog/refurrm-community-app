module.exports=[64484,a=>a.a(async(b,c)=>{try{var d=a.i(8171),e=a.i(9562),f=a.i(32165),g=a.i(23655),h=a.i(76311),i=b([e,f,g,h]);function j({filters:a,onFilterChange:b,facilities:c}){return(0,d.jsxs)("div",{className:"bg-white p-6 rounded-xl border-2 border-[#C8BFAE] space-y-4",children:[(0,d.jsx)("h3",{className:"font-['Poppins'] font-semibold text-xl text-[#1C2E25]",children:"Filters"}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-[#315E47] mb-2",children:"Search"}),(0,d.jsx)(f.Input,{placeholder:"Unit number, tenant...",value:a.search,onChange:a=>b("search",a.target.value)})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-[#315E47] mb-2",children:"Facility"}),(0,d.jsxs)(h.Select,{value:a.facility,onValueChange:a=>b("facility",a),children:[(0,d.jsx)(h.SelectTrigger,{children:(0,d.jsx)(h.SelectValue,{placeholder:"All Facilities"})}),(0,d.jsxs)(h.SelectContent,{children:[(0,d.jsx)(h.SelectItem,{value:"all",children:"All Facilities"}),c.map(a=>(0,d.jsx)(h.SelectItem,{value:a.id,children:a.name},a.id))]})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-[#315E47] mb-2",children:"Status"}),(0,d.jsxs)(h.Select,{value:a.status,onValueChange:a=>b("status",a),children:[(0,d.jsx)(h.SelectTrigger,{children:(0,d.jsx)(h.SelectValue,{placeholder:"All Statuses"})}),(0,d.jsxs)(h.SelectContent,{children:[(0,d.jsx)(h.SelectItem,{value:"all",children:"All Statuses"}),(0,d.jsx)(h.SelectItem,{value:"pending",children:"Pending"}),(0,d.jsx)(h.SelectItem,{value:"in_progress",children:"In Progress"}),(0,d.jsx)(h.SelectItem,{value:"completed",children:"Completed"}),(0,d.jsx)(h.SelectItem,{value:"cancelled",children:"Cancelled"})]})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-[#315E47] mb-2",children:"Priority"}),(0,d.jsxs)(h.Select,{value:a.priority,onValueChange:a=>b("priority",a),children:[(0,d.jsx)(h.SelectTrigger,{children:(0,d.jsx)(h.SelectValue,{placeholder:"All Priorities"})}),(0,d.jsxs)(h.SelectContent,{children:[(0,d.jsx)(h.SelectItem,{value:"all",children:"All Priorities"}),(0,d.jsx)(h.SelectItem,{value:"high",children:"High"}),(0,d.jsx)(h.SelectItem,{value:"medium",children:"Medium"}),(0,d.jsx)(h.SelectItem,{value:"low",children:"Low"})]})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-[#315E47] mb-2",children:"From Date"}),(0,d.jsx)(f.Input,{type:"date",value:a.dateFrom,onChange:a=>b("dateFrom",a.target.value)})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-[#315E47] mb-2",children:"To Date"}),(0,d.jsx)(f.Input,{type:"date",value:a.dateTo,onChange:a=>b("dateTo",a.target.value)})]})]})]})}[e,f,g,h]=i.then?(await i)():i,a.s(["default",()=>j]),c()}catch(a){c(a)}},!1),66930,a=>a.a(async(b,c)=>{try{var d=a.i(8171),e=a.i(57050),f=a.i(81170),g=a.i(65660),h=a.i(54763),i=b([e,f,g,h]);function j({submission:a,onViewDetails:b,onAssign:c,onUpdateStatus:e}){return(0,d.jsxs)("div",{className:"bg-white p-6 rounded-xl border-2 border-[#C8BFAE] hover:border-[#50E3E3] transition-colors",children:[(0,d.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("h3",{className:"font-['Poppins'] font-semibold text-xl text-[#1C2E25]",children:["Unit ",a.unit_number]}),(0,d.jsx)("p",{className:"text-[#315E47]",children:a.tenant_name}),(0,d.jsx)("p",{className:"text-sm text-gray-500",children:a.facility_name})]}),(0,d.jsxs)("div",{className:"flex flex-col gap-2 items-end",children:[(0,d.jsx)(f.Badge,{className:{pending:"bg-yellow-100 text-yellow-800",in_progress:"bg-blue-100 text-blue-800",completed:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"}[a.status]||"bg-gray-100",children:a.status.replace("_"," ")}),(0,d.jsx)(f.Badge,{className:{high:"bg-red-100 text-red-800",medium:"bg-orange-100 text-orange-800",low:"bg-gray-100 text-gray-800"}[a.priority]||"bg-gray-100",children:a.priority})]})]}),(0,d.jsxs)("div",{className:"space-y-2 mb-4 text-sm",children:[(0,d.jsxs)("p",{className:"text-gray-600",children:["Submitted: ",new Date(a.created_at).toLocaleDateString()]}),a.assigned_to_name&&(0,d.jsxs)("p",{className:"text-gray-600",children:["Assigned to: ",a.assigned_to_name]}),(0,d.jsxs)("p",{className:"text-gray-600",children:["Family Contacted: ",a.family_contacted?"✓ Yes":"✗ No"]})]}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)(h.Button,{onClick:()=>b(a.id),variant:"outline",size:"sm",children:"View Details"}),(0,d.jsx)(h.Button,{onClick:()=>c(a.id),variant:"outline",size:"sm",children:"Assign"}),(0,d.jsx)(h.Button,{onClick:()=>e(a.id),variant:"outline",size:"sm",children:"Update Status"})]})]})}[e,f,g,h]=i.then?(await i)():i,a.s(["default",()=>j]),c()}catch(a){c(a)}},!1),79338,a=>a.a(async(b,c)=>{try{var d=a.i(8171),e=a.i(27669),f=a.i(95955),g=a.i(21819),h=a.i(23655),i=a.i(76311),j=a.i(81024),k=a.i(91596),l=a.i(65660),m=a.i(54763),n=a.i(34348),o=a.i(80403),p=b([f,g,h,i,j,k,l,m]);function q({open:a,onClose:b,submissionId:c,onSuccess:f}){let[h,j]=(0,e.useState)([]),[l,p]=(0,e.useState)(""),[q,r]=(0,e.useState)(""),[s,t]=(0,e.useState)(!1),{toast:u}=(0,o.useToast)();(0,e.useEffect)(()=>{a&&v()},[a]);let v=async()=>{let{data:a}=await n.supabase.from("users").select("id, email, full_name").in("role",["volunteer","admin"]);a&&j(a)},w=async()=>{if(!l)return void u({title:"Please select a volunteer",variant:"destructive"});t(!0);try{let{data:{user:a}}=await n.supabase.auth.getUser(),{error:d}=await n.supabase.from("submission_assignments").insert({submission_id:c,assigned_to:l,assigned_by:a?.id,notes:q});if(d)throw d;await n.supabase.from("facility_submissions").update({status:"in_progress"}).eq("id",c),u({title:"Assignment successful"}),f(),b()}catch(a){u({title:"Error assigning",description:a.message,variant:"destructive"})}finally{t(!1)}};return(0,d.jsx)(g.Dialog,{open:a,onOpenChange:b,children:(0,d.jsxs)(g.DialogContent,{children:[(0,d.jsx)(g.DialogHeader,{children:(0,d.jsx)(g.DialogTitle,{children:"Assign Rescue Request"})}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Assign To"}),(0,d.jsxs)(i.Select,{value:l,onValueChange:p,children:[(0,d.jsx)(i.SelectTrigger,{children:(0,d.jsx)(i.SelectValue,{placeholder:"Select volunteer"})}),(0,d.jsx)(i.SelectContent,{children:h.map(a=>(0,d.jsx)(i.SelectItem,{value:a.id,children:a.full_name||a.email},a.id))})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Notes"}),(0,d.jsx)(k.Textarea,{value:q,onChange:a=>r(a.target.value),placeholder:"Add assignment notes...",rows:3})]}),(0,d.jsx)(m.Button,{onClick:w,disabled:s,className:"w-full",children:s?"Assigning...":"Assign"})]})]})})}[f,g,h,i,j,k,l,m]=p.then?(await p)():p,a.s(["default",()=>q]),c()}catch(a){c(a)}},!1),26041,a=>a.a(async(b,c)=>{try{var d=a.i(8171),e=a.i(27669),f=a.i(95955),g=a.i(21819),h=a.i(65660),i=a.i(54763),j=a.i(81024),k=a.i(91596),l=a.i(57050),m=a.i(81170),n=a.i(34348),o=a.i(80403),p=b([f,g,h,i,j,k,l,m]);function q({open:a,onClose:b,submissionId:c,onSuccess:f}){let[h,j]=(0,e.useState)(null),[l,p]=(0,e.useState)([]),[q,r]=(0,e.useState)([]),[s,t]=(0,e.useState)(""),[u,v]=(0,e.useState)(""),{toast:w}=(0,o.useToast)();(0,e.useEffect)(()=>{a&&c&&x()},[a,c]);let x=async()=>{let{data:a}=await n.supabase.from("facility_submissions").select("*, storage_facilities(name)").eq("id",c).single(),{data:b}=await n.supabase.from("rescue_notes").select("*, users(email)").eq("submission_id",c).order("created_at",{ascending:!1}),{data:d}=await n.supabase.from("rescue_photos").select("*").eq("submission_id",c);a&&j(a),b&&p(b),d&&r(d)},y=async()=>{if(!s.trim())return;let{data:{user:a}}=await n.supabase.auth.getUser(),{error:b}=await n.supabase.from("rescue_notes").insert({submission_id:c,user_id:a?.id,note:s});b||(w({title:"Note added"}),t(""),x())},z=async()=>{let{data:{user:a}}=await n.supabase.auth.getUser(),{error:b}=await n.supabase.from("facility_submissions").update({family_contacted:!0,family_contacted_at:new Date().toISOString(),family_contacted_by:a?.id}).eq("id",c);b||(w({title:"Marked as contacted"}),x(),f())};return h?(0,d.jsx)(g.Dialog,{open:a,onOpenChange:b,children:(0,d.jsxs)(g.DialogContent,{className:"max-w-3xl max-h-[80vh] overflow-y-auto",children:[(0,d.jsx)(g.DialogHeader,{children:(0,d.jsx)(g.DialogTitle,{children:"Rescue Request Details"})}),(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm text-gray-500",children:"Unit Number"}),(0,d.jsx)("p",{className:"font-semibold",children:h.unit_number})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm text-gray-500",children:"Tenant Name"}),(0,d.jsx)("p",{className:"font-semibold",children:h.tenant_name})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm text-gray-500",children:"Facility"}),(0,d.jsx)("p",{className:"font-semibold",children:h.storage_facilities?.name})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm text-gray-500",children:"Status"}),(0,d.jsx)(m.Badge,{children:h.status})]})]}),h.tenant_phone&&(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm text-gray-500",children:"Phone"}),(0,d.jsx)("p",{children:h.tenant_phone})]}),h.unit_contents&&(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm text-gray-500",children:"Contents"}),(0,d.jsx)("p",{children:h.unit_contents})]}),(0,d.jsx)("div",{children:(0,d.jsx)(i.Button,{onClick:z,disabled:h.family_contacted,variant:h.family_contacted?"outline":"default",children:h.family_contacted?"✓ Family Contacted":"Mark Family as Contacted"})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h4",{className:"font-semibold mb-2",children:"Add Note"}),(0,d.jsx)(k.Textarea,{value:s,onChange:a=>t(a.target.value),placeholder:"Add rescue notes...",rows:3}),(0,d.jsx)(i.Button,{onClick:y,className:"mt-2",children:"Add Note"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h4",{className:"font-semibold mb-2",children:"Notes History"}),(0,d.jsx)("div",{className:"space-y-2",children:l.map(a=>(0,d.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,d.jsx)("p",{className:"text-sm",children:a.note}),(0,d.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[a.users?.email," - ",new Date(a.created_at).toLocaleString()]})]},a.id))})]})]})]})}):null}[f,g,h,i,j,k,l,m]=p.then?(await p)():p,a.s(["default",()=>q]),c()}catch(a){c(a)}},!1),97420,a=>a.a(async(b,c)=>{try{var d=a.i(8171),e=a.i(27669),f=a.i(34348),g=a.i(64484),h=a.i(66930),i=a.i(79338),j=a.i(26041),k=a.i(65660),l=a.i(54763),m=a.i(80403),n=b([g,h,i,j,k,l]);function o(){let[a,b]=(0,e.useState)([]),[c,k]=(0,e.useState)([]),[n,o]=(0,e.useState)({facility:"all",status:"all",priority:"all",dateFrom:"",dateTo:"",search:""}),[p,q]=(0,e.useState)(null),[r,s]=(0,e.useState)(!1),[t,u]=(0,e.useState)(!1),[v,w]=(0,e.useState)({total:0,pending:0,inProgress:0,completed:0}),{toast:x}=(0,m.useToast)();(0,e.useEffect)(()=>{y(),z()},[n]);let y=async()=>{let{data:a}=await f.supabase.from("storage_facilities").select("id, name");a&&k(a)},z=async()=>{let a=f.supabase.from("facility_submissions").select(`
        *,
        storage_facilities(name),
        submission_assignments(assigned_to, users(email, full_name))
      `).order("created_at",{ascending:!1});"all"!==n.facility&&(a=a.eq("facility_id",n.facility)),"all"!==n.status&&(a=a.eq("status",n.status)),"all"!==n.priority&&(a=a.eq("priority",n.priority)),n.dateFrom&&(a=a.gte("created_at",n.dateFrom)),n.dateTo&&(a=a.lte("created_at",n.dateTo)),n.search&&(a=a.or(`unit_number.ilike.%${n.search}%,tenant_name.ilike.%${n.search}%`));let{data:c}=await a;if(c){let a=c.map(a=>({...a,facility_name:a.storage_facilities?.name,assigned_to_name:a.submission_assignments?.[0]?.users?.full_name||a.submission_assignments?.[0]?.users?.email}));b(a),w({total:c.length,pending:c.filter(a=>"pending"===a.status).length,inProgress:c.filter(a=>"in_progress"===a.status).length,completed:c.filter(a=>"completed"===a.status).length})}},A=a=>{q(a),s(!0)},B=a=>{q(a),u(!0)},C=async b=>{let c=a.find(a=>a.id===b),d=["pending","in_progress","completed"],e=d.indexOf(c?.status||"pending"),g=d[(e+1)%d.length],{error:h}=await f.supabase.from("facility_submissions").update({status:g}).eq("id",b);h||(x({title:`Status updated to ${g}`}),z())};return(0,d.jsxs)("div",{className:"min-h-screen bg-[#F6F4EE] py-12",children:[(0,d.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,d.jsxs)("div",{className:"mb-8",children:[(0,d.jsx)("h1",{className:"font-['Poppins'] font-bold text-5xl text-[#1C2E25] mb-2",children:"Admin Dashboard"}),(0,d.jsx)("p",{className:"text-[#315E47] text-lg",children:"Manage rescue operations across all facilities"})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,d.jsxs)("div",{className:"bg-white p-6 rounded-xl border-2 border-[#C8BFAE]",children:[(0,d.jsx)("p",{className:"text-sm text-[#315E47] mb-1",children:"Total Submissions"}),(0,d.jsx)("p",{className:"font-['Poppins'] font-bold text-4xl text-[#1C2E25]",children:v.total})]}),(0,d.jsxs)("div",{className:"bg-white p-6 rounded-xl border-2 border-[#C8BFAE]",children:[(0,d.jsx)("p",{className:"text-sm text-[#315E47] mb-1",children:"Pending"}),(0,d.jsx)("p",{className:"font-['Poppins'] font-bold text-4xl text-yellow-600",children:v.pending})]}),(0,d.jsxs)("div",{className:"bg-white p-6 rounded-xl border-2 border-[#C8BFAE]",children:[(0,d.jsx)("p",{className:"text-sm text-[#315E47] mb-1",children:"In Progress"}),(0,d.jsx)("p",{className:"font-['Poppins'] font-bold text-4xl text-blue-600",children:v.inProgress})]}),(0,d.jsxs)("div",{className:"bg-white p-6 rounded-xl border-2 border-[#C8BFAE]",children:[(0,d.jsx)("p",{className:"text-sm text-[#315E47] mb-1",children:"Completed"}),(0,d.jsx)("p",{className:"font-['Poppins'] font-bold text-4xl text-green-600",children:v.completed})]})]}),(0,d.jsx)("div",{className:"mb-6",children:(0,d.jsx)(l.Button,{onClick:()=>{let b=["Unit,Tenant,Facility,Status,Priority,Date,Assigned To",...a.map(a=>[a.unit_number,a.tenant_name,a.facility_name,a.status,a.priority,new Date(a.created_at).toLocaleDateString(),a.assigned_to_name||"Unassigned"].join(","))].join("\n"),c=new Blob([b],{type:"text/csv"}),d=URL.createObjectURL(c),e=document.createElement("a");e.href=d,e.download=`rescue-report-${new Date().toISOString().split("T")[0]}.csv`,e.click()},variant:"outline",children:"Export Report (CSV)"})}),(0,d.jsx)(g.default,{filters:n,onFilterChange:(a,b)=>{o(c=>({...c,[a]:b}))},facilities:c}),(0,d.jsx)("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(a=>(0,d.jsx)(h.default,{submission:a,onViewDetails:B,onAssign:A,onUpdateStatus:C},a.id))}),0===a.length&&(0,d.jsx)("div",{className:"text-center py-12 text-gray-500",children:"No submissions found matching your filters"})]}),p&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(i.default,{open:r,onClose:()=>s(!1),submissionId:p,onSuccess:z}),(0,d.jsx)(j.default,{open:t,onClose:()=>u(!1),submissionId:p,onSuccess:z})]})]})}[g,h,i,j,k,l]=n.then?(await n)():n,a.s(["default",()=>o]),c()}catch(a){c(a)}},!1),64840,a=>a.a(async(b,c)=>{try{var d=a.i(89870),e=a.i(89106),f=a.i(44450),g=a.i(69503),h=a.i(54212),i=a.i(97420),j=a.i(10827),k=b([h,i]);[h,i]=k.then?(await k)():k;let l=(0,f.hoist)(i,"default"),m=(0,f.hoist)(i,"getStaticProps"),n=(0,f.hoist)(i,"getStaticPaths"),o=(0,f.hoist)(i,"getServerSideProps"),p=(0,f.hoist)(i,"config"),q=(0,f.hoist)(i,"reportWebVitals"),r=(0,f.hoist)(i,"unstable_getStaticProps"),s=(0,f.hoist)(i,"unstable_getStaticPaths"),t=(0,f.hoist)(i,"unstable_getStaticParams"),u=(0,f.hoist)(i,"unstable_getServerProps"),v=(0,f.hoist)(i,"unstable_getServerSideProps"),w=new d.PagesRouteModule({definition:{kind:e.RouteKind.PAGES,page:"/Admin",pathname:"/Admin",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:h.default,Document:g.default},userland:i}),x=(0,j.getHandler)({srcPage:"/Admin",config:p,userland:i,routeModule:w,getStaticPaths:n,getStaticProps:m,getServerSideProps:o});a.s(["config",0,p,"default",0,l,"getServerSideProps",0,o,"getStaticPaths",0,n,"getStaticProps",0,m,"handler",0,x,"reportWebVitals",0,q,"routeModule",0,w,"unstable_getServerProps",0,u,"unstable_getServerSideProps",0,v,"unstable_getStaticParams",0,t,"unstable_getStaticPaths",0,s,"unstable_getStaticProps",0,r]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=Sites_solid-octo-enigma_c671271f._.js.map